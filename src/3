#include "main.h"

// Core //

extern void update_game(app_t *app)
{
    renderer_t *renderer = &app->renderer;
    game_data_t *data = &app->game_data;

    if (!data->initialized)
    {
        renderer->set_clear_color(renderer, 1.f, 0.f, 0.f, 1.f);

        data->x = 100;
        data->y = 150;

        // printf("X: %d, Y: %d, W: %d, H: %d\n", data->x, data->y, data->width, data->height);

        data->initialized = 1;
    }


    void *texture_data = NULL;
    gs_util_load_texture_data_from_file("./assets/characters.png",
                                        &data->width, &data->height,
                                        &data->num_comps, &texture_data, 1);

    ga_handle(gs_graphics_texture_t) tex = gs_graphics_texture_create (
        &(gs_graphics_texture_desc_t) {
            .type = GS_GRAPHICS_TEXTURE_2D, 
            .width = data->width,
            .height = data->height, 
            .data = texture_data,
            .format = GS_GRAPHICS_TEXTURE_FORMAT_RGBA8,
            .min_filter = GS_GRAPHICS_TEXTURE_FILTER_NEAREST, 
            .mag_filter = GS_GRAPHICS_TEXTURE_FILTER_NEAREST
        }
    );


    renderer->draw_texture(&renderer->render_queue, gs_v2(data->x, data->y),
                           gs_v2(data->width, data->height), data->tex);
}

